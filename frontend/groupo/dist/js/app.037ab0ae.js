(()=>{var e={46700:(e,t,s)=>{var r={"./af":63906,"./af.js":63906,"./ar":40902,"./ar-dz":3853,"./ar-dz.js":3853,"./ar-kw":20299,"./ar-kw.js":20299,"./ar-ly":96825,"./ar-ly.js":96825,"./ar-ma":66379,"./ar-ma.js":66379,"./ar-sa":87700,"./ar-sa.js":87700,"./ar-tn":2059,"./ar-tn.js":2059,"./ar.js":40902,"./az":76043,"./az.js":76043,"./be":7936,"./be.js":7936,"./bg":34078,"./bg.js":34078,"./bm":14014,"./bm.js":14014,"./bn":29554,"./bn-bd":17114,"./bn-bd.js":17114,"./bn.js":29554,"./bo":6529,"./bo.js":6529,"./br":65437,"./br.js":65437,"./bs":19647,"./bs.js":19647,"./ca":59951,"./ca.js":59951,"./cs":26113,"./cs.js":26113,"./cv":37965,"./cv.js":37965,"./cy":35858,"./cy.js":35858,"./da":33515,"./da.js":33515,"./de":62831,"./de-at":6263,"./de-at.js":6263,"./de-ch":51127,"./de-ch.js":51127,"./de.js":62831,"./dv":4510,"./dv.js":4510,"./el":68616,"./el.js":68616,"./en-au":24595,"./en-au.js":24595,"./en-ca":73545,"./en-ca.js":73545,"./en-gb":79609,"./en-gb.js":79609,"./en-ie":43727,"./en-ie.js":43727,"./en-il":93302,"./en-il.js":93302,"./en-in":46305,"./en-in.js":46305,"./en-nz":39128,"./en-nz.js":39128,"./en-sg":84569,"./en-sg.js":84569,"./eo":50650,"./eo.js":50650,"./es":26358,"./es-do":64214,"./es-do.js":64214,"./es-mx":38639,"./es-mx.js":38639,"./es-us":30232,"./es-us.js":30232,"./es.js":26358,"./et":47279,"./et.js":47279,"./eu":15515,"./eu.js":15515,"./fa":27981,"./fa.js":27981,"./fi":37090,"./fi.js":37090,"./fil":79208,"./fil.js":79208,"./fo":2799,"./fo.js":2799,"./fr":23463,"./fr-ca":2213,"./fr-ca.js":2213,"./fr-ch":52848,"./fr-ch.js":52848,"./fr.js":23463,"./fy":41468,"./fy.js":41468,"./ga":88163,"./ga.js":88163,"./gd":2898,"./gd.js":2898,"./gl":76312,"./gl.js":76312,"./gom-deva":20682,"./gom-deva.js":20682,"./gom-latn":49178,"./gom-latn.js":49178,"./gu":31400,"./gu.js":31400,"./he":52795,"./he.js":52795,"./hi":17009,"./hi.js":17009,"./hr":46506,"./hr.js":46506,"./hu":69565,"./hu.js":69565,"./hy-am":93864,"./hy-am.js":93864,"./id":5626,"./id.js":5626,"./is":36649,"./is.js":36649,"./it":90151,"./it-ch":95348,"./it-ch.js":95348,"./it.js":90151,"./ja":79830,"./ja.js":79830,"./jv":33751,"./jv.js":33751,"./ka":63365,"./ka.js":63365,"./kk":85980,"./kk.js":85980,"./km":99571,"./km.js":99571,"./kn":25880,"./kn.js":25880,"./ko":16809,"./ko.js":16809,"./ku":96773,"./ku.js":96773,"./ky":65505,"./ky.js":65505,"./lb":50553,"./lb.js":50553,"./lo":51237,"./lo.js":51237,"./lt":91563,"./lt.js":91563,"./lv":61057,"./lv.js":61057,"./me":96495,"./me.js":96495,"./mi":83096,"./mi.js":83096,"./mk":43874,"./mk.js":43874,"./ml":46055,"./ml.js":46055,"./mn":87747,"./mn.js":87747,"./mr":17113,"./mr.js":17113,"./ms":8687,"./ms-my":7948,"./ms-my.js":7948,"./ms.js":8687,"./mt":14532,"./mt.js":14532,"./my":4655,"./my.js":4655,"./nb":56961,"./nb.js":56961,"./ne":2512,"./ne.js":2512,"./nl":48448,"./nl-be":72936,"./nl-be.js":72936,"./nl.js":48448,"./nn":49031,"./nn.js":49031,"./oc-lnc":5174,"./oc-lnc.js":5174,"./pa-in":30118,"./pa-in.js":30118,"./pl":93448,"./pl.js":93448,"./pt":33518,"./pt-br":62447,"./pt-br.js":62447,"./pt.js":33518,"./ro":70817,"./ro.js":70817,"./ru":10262,"./ru.js":10262,"./sd":58990,"./sd.js":58990,"./se":43842,"./se.js":43842,"./si":37711,"./si.js":37711,"./sk":80756,"./sk.js":80756,"./sl":3772,"./sl.js":3772,"./sq":6187,"./sq.js":6187,"./sr":40732,"./sr-cyrl":75713,"./sr-cyrl.js":75713,"./sr.js":40732,"./ss":99455,"./ss.js":99455,"./sv":69770,"./sv.js":69770,"./sw":80959,"./sw.js":80959,"./ta":36459,"./ta.js":36459,"./te":25302,"./te.js":25302,"./tet":67975,"./tet.js":67975,"./tg":71294,"./tg.js":71294,"./th":2385,"./th.js":2385,"./tk":24613,"./tk.js":24613,"./tl-ph":58668,"./tl-ph.js":58668,"./tlh":58190,"./tlh.js":58190,"./tr":74506,"./tr.js":74506,"./tzl":63440,"./tzl.js":63440,"./tzm":69852,"./tzm-latn":42350,"./tzm-latn.js":42350,"./tzm.js":69852,"./ug-cn":70730,"./ug-cn.js":70730,"./uk":40099,"./uk.js":40099,"./ur":72100,"./ur.js":72100,"./uz":96002,"./uz-latn":26322,"./uz-latn.js":26322,"./uz.js":96002,"./vi":14207,"./vi.js":14207,"./x-pseudo":24674,"./x-pseudo.js":24674,"./yo":10570,"./yo.js":10570,"./zh-cn":73644,"./zh-cn.js":73644,"./zh-hk":22591,"./zh-hk.js":22591,"./zh-mo":89503,"./zh-mo.js":89503,"./zh-tw":88080,"./zh-tw.js":88080};function n(e){var t=a(e);return s(t)}function a(e){if(!s.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=a,e.exports=n,n.id=46700},95153:(e,t,s)=>{"use strict";s(66992),s(88674),s(19601),s(17727),s(48052);var r=s(35010),n=s(73396);function a(e,t,s,r,a,o){var i=(0,n.up)("NavBar"),l=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(i),(0,n.Wm)(l)])}const o=s.p+"img/icon-left-font-1.0b85d620.png";var i=function(e){return(0,n.dD)("data-v-af0a5cea"),e=e(),(0,n.Cn)(),e},l={class:"navbar navbar-expand-lg navbar-light bg-white"},u={class:"container"},c=i((function(){return(0,n._)("img",{src:o,alt:"logo Groupomania",class:"d-inline-block align-text-top logo"},null,-1)})),d=i((function(){return(0,n._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,n._)("span",{class:"navbar-toggler-icon"})],-1)})),p={class:"collapse navbar-collapse",id:"navbarNav"},m={key:0,class:"navbar-nav ms-auto"},g={class:"nav-item"},f=(0,n.Uk)("Se connecter"),v={class:"nav-item"},b=(0,n.Uk)("S'inscrire"),h={key:1,class:"navbar-nav ms-auto"},w={class:"nav-item nav-item-home"},k=i((function(){return(0,n._)("i",{class:"fas fa-home logo-home",title:"Accueil"},null,-1)})),y={class:"nav-item"},j={class:"avatar-container"},_=["src"],I={class:"nav-item nav-item-logout"};function x(e,t,s,r,a,o){var i=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("nav",l,[(0,n._)("div",u,[(0,n.Wm)(i,{to:"/",class:"navbar-brand"},{default:(0,n.w5)((function(){return[c]})),_:1}),d,(0,n._)("div",p,[e.loggedIn?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("ul",m,[(0,n._)("li",g,[(0,n.Wm)(i,{to:"/login",class:"nav-link login-link"},{default:(0,n.w5)((function(){return[f]})),_:1})]),(0,n._)("li",v,[(0,n.Wm)(i,{to:"/signup",class:"nav-link signup-link"},{default:(0,n.w5)((function(){return[b]})),_:1})])])),e.loggedIn?((0,n.wg)(),(0,n.iD)("ul",h,[(0,n._)("li",w,[(0,n.Wm)(i,{to:"/",class:"nav-link d-flex"},{default:(0,n.w5)((function(){return[k]})),_:1})]),(0,n._)("li",y,[(0,n.Wm)(i,{to:{name:"view-profile",params:{id:e.user.id}},class:"nav-link profile-link","data-toggle":"tooltip","data-placement":"bottom",title:"Profil de "+e.user.username},{default:(0,n.w5)((function(){return[(0,n._)("div",j,[(0,n._)("img",{src:e.user.avatar,alt:"avatar account"},null,8,_)])]})),_:1},8,["to","title"])]),(0,n._)("li",I,[(0,n._)("button",{onClick:t[0]||(t[0]=function(){return o.logOut&&o.logOut.apply(o,arguments)}),class:"nav-link logout-link btn btn-groupo"},"Se déconnecter")])])):(0,n.kq)("",!0)])])])}var S=s(95082),M=s(20065);const E={name:"NavBar",methods:{logOut:function(){localStorage.removeItem("userId"),localStorage.removeItem("token"),localStorage.removeItem("user"),this.$store.dispatch("setUser",null),this.$store.dispatch("setLogout"),alert("Vous êtes déconnecté(e) !"),this.$router.push("/")}},computed:(0,S.Z)((0,S.Z)({},(0,M.Se)(["user"])),(0,M.Se)(["loggedIn"])),beforeMount:function(){this.$store.dispatch("checkToken")}};var D=s(40089);const Z=(0,D.Z)(E,[["render",x],["__scopeId","data-v-af0a5cea"]]),U=Z,F={name:"app",components:{NavBar:U}},L=(0,D.Z)(F,[["render",a]]),$=L;var z=s(22483);const P=s.p+"img/icon-above-font.d05a0ffc.png";var C=function(e){return(0,n.dD)("data-v-90a29676"),e=e(),(0,n.Cn)(),e},T={class:"container-compo mx-auto"},O={key:0,class:"wall mx-auto"},A=C((function(){return(0,n._)("h1",{class:"wall-title my-4"},"Le fil d'actualité",-1)})),q={key:1,class:"welcome mx-auto"},N=C((function(){return(0,n._)("img",{src:P,alt:"logo Groupomania",class:"logo mx-auto d-block"},null,-1)})),B=C((function(){return(0,n._)("h1",{class:"welcome-title mt-4"},"Bienvenue sur le réseau social de Groupomania",-1)})),V=C((function(){return(0,n._)("p",{class:"welcome-text mt-4"},"Inscrivez-vous pour partager vos idées et vos inspirations et rester en contact avec vos collègues !",-1)})),R={class:"d-flex align-items-center justify-content-between mt-5 welcome-btns"},W=(0,n.Uk)("Créer un compte"),G=C((function(){return(0,n._)("span",{class:"ms-auto"},"Vous avez déjà un compte ?",-1)})),J=(0,n.Uk)("Se connecter");function H(e,t,s,r,a,o){var i=(0,n.up)("NewPost"),l=(0,n.up)("Feed"),u=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",T,[e.user?((0,n.wg)(),(0,n.iD)("div",O,[A,(0,n.Wm)(i,{onNewpost:o.setReload},null,8,["onNewpost"]),((0,n.wg)(),(0,n.j4)(l,{key:a.compoKey}))])):((0,n.wg)(),(0,n.iD)("div",q,[N,B,V,(0,n._)("div",R,[(0,n.Wm)(u,{to:"/signup",class:"btn btn-primary btn-signup"},{default:(0,n.w5)((function(){return[W]})),_:1}),G,(0,n.Wm)(u,{to:"/login",class:"btn btn-primary btn-login"},{default:(0,n.w5)((function(){return[J]})),_:1})])]))])}var Y={id:"feed",class:"mt-5"},K={class:"feed-posts mx-auto"},Q={key:0,class:"mx-auto"},X={key:1,class:"zero-post text-center"};function ee(e,t,s,r,a,o){var i=(0,n.up)("PostItem");return(0,n.wg)(),(0,n.iD)("section",Y,[(0,n._)("div",K,[a.posts.length>0?((0,n.wg)(),(0,n.iD)("ul",Q,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.posts,(function(e){return(0,n.wg)(),(0,n.iD)("li",{key:e.id,class:"mb-5"},[(0,n.Wm)(i,{post:e,onPostdeleted:t[0]||(t[0]=function(e){return o.getAllPosts()}),onPostupdated:t[1]||(t[1]=function(e){return o.getAllPosts()})},null,8,["post"])])})),128))])):((0,n.wg)(),(0,n.iD)("p",X,"Aucun post publié pour l'instant !"))])])}var te=s(50124),se=s(48534),re=s(87139),ne=function(e){return(0,n.dD)("data-v-2345d7f4"),e=e(),(0,n.Cn)(),e},ae={class:"card post-card"},oe={class:"card-header bg-white p-3"},ie={class:"d-flex justify-content-between align-items-center"},le={class:"d-flex justify-content-between align-items-center"},ue={class:"me-2"},ce=["src"],de={class:"ms-2"},pe={class:"h5 m-0 post-username"},me={class:"h7 text-muted post-time"},ge={key:0,class:"dropdown"},fe=["id"],ve=ne((function(){return(0,n._)("i",{class:"fas fa-ellipsis-h ellipsis-icon"},null,-1)})),be=[ve],he=["aria-labelledby"],we={class:"card-body"},ke={class:"card-text",ref:"mycardtext"},ye=["src"],je={key:0,class:"card-body"},_e=ne((function(){return(0,n._)("h3",{class:"text-center mb-3"},"Modifier la publication",-1)})),Ie={class:"mb-3"},xe=ne((function(){return(0,n._)("label",{for:"messageInput",class:"form-label"},"Message",-1)})),Se={class:"mb-3"},Me=ne((function(){return(0,n._)("label",{for:"imageInput",class:"form-label mb-3 d-block"},"Image",-1)})),Ee=["src"],De={key:0,class:"validFeedback"},Ze={key:1,class:"validFeedback"},Ue=["disabled"];function Fe(e,t,s,a,o,i){var l=(0,n.up)("LikeItem");return(0,n.wg)(),(0,n.iD)("div",ae,[(0,n._)("div",oe,[(0,n._)("div",ie,[(0,n._)("div",le,[(0,n._)("div",ue,[(0,n._)("img",{class:"rounded-circle avatar",src:s.post.User.avatar,alt:"avatar"},null,8,ce)]),(0,n._)("div",de,[(0,n._)("div",pe,(0,re.zw)(s.post.User.username),1),(0,n._)("div",me,(0,re.zw)(i.formatTime(s.post.createdAt)),1)])]),e.user.id===s.post.User.id||e.user.isAdmin?((0,n.wg)(),(0,n.iD)("div",ge,[(0,n._)("a",{class:"btn btn-white",type:"button",id:"dropdownMenuButton"+s.post.id,"data-bs-toggle":"dropdown","aria-expanded":"false"},be,8,fe),(0,n._)("ul",{class:"dropdown-menu dropdown-menu-right","aria-labelledby":"dropdownMenuButton"+s.post.id},[(0,n._)("li",null,[e.user.id===s.post.User.id?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"dropdown-item",onClick:t[0]||(t[0]=function(e){return i.editPost(s.post.id)})},"Modifier")):(0,n.kq)("",!0)]),(0,n._)("li",null,[(0,n._)("button",{class:"dropdown-item dropdown-item-delete",onClick:t[1]||(t[1]=function(e){return i.deletePost(s.post.id)})},"Supprimer")])],8,he)])):(0,n.kq)("",!0)])]),(0,n.wy)((0,n._)("div",we,[(0,n._)("p",ke,null,512),s.post.imageUrl?((0,n.wg)(),(0,n.iD)("img",{key:0,loading:"lazy",src:s.post.imageUrl,alt:"image",class:"post-image"},null,8,ye)):(0,n.kq)("",!0)],512),[[r.F8,!o.toModify]]),o.toModify?((0,n.wg)(),(0,n.iD)("div",je,[_e,(0,n._)("form",{onSubmit:t[8]||(t[8]=(0,r.iM)((function(){return i.modifyPost&&i.modifyPost.apply(i,arguments)}),["prevent"])),id:"myForm",enctype:"multipart/form-data",class:"mb-3"},[(0,n._)("div",Ie,[xe,(0,n.wy)((0,n._)("textarea",{onClick:t[2]||(t[2]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.messageEdit=e}),type:"text",class:"form-control",id:"messageInput",rows:"5"},null,512),[[r.nr,o.messageEdit]])]),(0,n._)("div",Se,[Me,o.previewImageEdit?((0,n.wg)(),(0,n.iD)("img",{key:0,class:"image-preview d-block mb-3",src:o.previewImageEdit},null,8,Ee)):(0,n.kq)("",!0),o.previewImageEdit?((0,n.wg)(),(0,n.iD)("button",{key:1,onClick:t[4]||(t[4]=(0,r.iM)((function(){return i.removeImage&&i.removeImage.apply(i,arguments)}),["prevent"])),class:"btn btn-danger mb-3"},"Retirer image")):(0,n.kq)("",!0),o.previewImageEdit?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("input",{key:2,class:"form-control btn-upload mb-3",type:"file",id:"imageInput",ref:"imageInput",onChange:t[5]||(t[5]=function(){return i.onFileSelected&&i.onFileSelected.apply(i,arguments)}),onClick:t[6]||(t[6]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)})},null,544))]),o.validEdit?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",De,(0,re.zw)(o.errorMessageEdit),1)),i.isEmptyContent?((0,n.wg)(),(0,n.iD)("p",Ze,"Un message seul doit contenir au moins deux caractères.")):(0,n.kq)("",!0),(0,n._)("button",{onClick:t[7]||(t[7]=(0,r.iM)((function(){return i.abort&&i.abort.apply(i,arguments)}),["prevent"])),class:"btn btn-light btn-space btn-abort"},"Annuler"),(0,n._)("button",{disabled:!o.validEdit||i.isEmptyContent,type:"submit",class:"btn btn-groupo"},"Sauvegarder",8,Ue)],32)])):(0,n.kq)("",!0),(0,n.Wm)(l,{postId:s.post.id,likes:o.likes},null,8,["postId","likes"])])}s(38862),s(26699);var Le=s(36797),$e=s.n(Le),ze=s(56265),Pe=s.n(ze);const Ce=Pe().create({baseURL:"http://localhost:3000/api/"});s(74916),s(15306);function Te(e){var t=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,s=e.replace(t,"<a href='$1'>$1</a>"),r=/(^|[^\/])(www\.[\S]+(\b|$))/gim;return s.replace(r,'$1<a target="_blank" href="http://$2">$2</a>')}var Oe={class:"card d-flex bg-white p-3 border-0 like-item"},Ae={class:"like-btn-container py-1 d-flex align-items-center justify-content-between"},qe={key:0,class:"far fa-heart like-icon me-2",ref:"icon"},Ne={key:1,class:"fas fa-heart like-icon me-2",ref:"icon"},Be={key:2,class:"like-text color-grey",ref:"text"},Ve={key:3,class:"like-text color-groupo",ref:"text"},Re={class:"count-like p-2"};function We(e,t,s,r,a,o){return(0,n.wg)(),(0,n.iD)("div",Oe,[(0,n._)("div",Ae,[(0,n._)("button",{type:"button",onClick:t[0]||(t[0]=function(){return o.handleLike&&o.handleLike.apply(o,arguments)}),class:"p-2 like-btn border-0 d-flex justify-content-center align-items-center"},[o.isLiked?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("i",qe,null,512)),o.isLiked?((0,n.wg)(),(0,n.iD)("i",Ne,null,512)):(0,n.kq)("",!0),o.isLiked?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",Be,"J'aime",512)),o.isLiked?((0,n.wg)(),(0,n.iD)("span",Ve,"J'aime",512)):(0,n.kq)("",!0)]),(0,n._)("span",Re,(0,re.zw)(a.countLikes)+" J'aime",1)])])}s(9653),s(21249),s(32023);const Ge={name:"LikeItem",props:{postId:Number,likes:Array},data:function(){return{countLikes:this.$props.likes.length}},computed:(0,S.Z)((0,S.Z)({},(0,M.Se)(["user"])),{},{isLiked:function(){var e=this.$props.likes.map((function(e){return e.User.id})),t=this.$store.state.user.id;return e.includes(t)}}),methods:{handleLike:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.displayLike(),s=e.$props.postId,r=localStorage.getItem("token"),t.prev=3,t.next=6,Ce.post("posts/".concat(s,"/like"),null,{headers:{Authorization:"Bearer ".concat(r)}});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](3),console.log(t.t0.response.data);case 11:case"end":return t.stop()}}),t,null,[[3,8]])})))()},displayLike:function(){var e=this.$refs.icon,t=this.$refs.text;e.classList.contains("far")?(e.classList.replace("far","fas"),e.classList.add("anim"),t.classList.replace("color-grey","color-groupo"),this.countLikes++):(e.classList.replace("fas","far"),e.classList.remove("anim"),t.classList.replace("color-groupo","color-grey"),this.countLikes--)}}},Je=(0,D.Z)(Ge,[["render",We],["__scopeId","data-v-213644da"]]),He=Je;$e().locale("fr");const Ye={name:"PostItem",props:{post:Object},components:{LikeItem:He},data:function(){return{postId:null,messageEdit:this.$props.post.content,selectedFileEdit:null,previewImageEdit:this.$props.post.imageUrl,previousImage:"",validEdit:!0,errorMessageEdit:"",toModify:!1,deleteImg:!1,keepPreviousImg:!1,showMore:!1,likes:this.$props.post.Likes}},computed:(0,S.Z)((0,S.Z)({},(0,M.Se)(["user"])),{},{isEmptyContent:function(){return""===this.previewImageEdit&&this.messageEdit.length<2}}),methods:{formatTime:function(e){var t=$e()();return $e().relativeTimeThreshold("m",60),$e().relativeTimeThreshold("h",24),t.diff(e,"years")>0?$e()(e).format("Do MMM YYYY"):t.diff(e,"minutes")>1440?$e()(e).format("Do MMM"):$e()(e).fromNow()},deletePost:function(e){var t=this;return(0,se.Z)((0,te.Z)().mark((function s(){var r,n,a;return(0,te.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(r=localStorage.getItem("token"),n=e,a=confirm("Vous êtes sûr(e) de supprimer ce post ?"),a){s.next=5;break}return s.abrupt("return");case 5:return s.prev=5,s.next=8,Ce["delete"]("posts/".concat(n),{headers:{Authorization:"Bearer ".concat(r)}});case 8:alert("Post supprimé !"),t.$emit("postdeleted"),s.next=15;break;case 12:s.prev=12,s.t0=s["catch"](5),console.log(s.t0.response.data);case 15:case"end":return s.stop()}}),s,null,[[5,12]])})))()},editPost:function(e){this.toModify=!0,this.postId=e},modifyPost:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r,n,a,o;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.keepPreviousImg=e.previewImageEdit===e.previousImage,s={content:e.messageEdit,deleteImg:e.deleteImg,keepPreviousImg:e.keepPreviousImg},r=s,null!==e.selectedFileEdit&&(n=new FormData,n.append("post",JSON.stringify({content:e.messageEdit})),n.append("image",e.selectedFileEdit),r=n),a=localStorage.getItem("token"),t.prev=5,t.next=8,Ce.put("posts/".concat(e.postId),r,{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});case 8:o=t.sent,alert("Les modifications ont bien été enregistrées !"),console.log("données mises à jour",o.data),e.selectedFileEdit=null,e.deleteImg=!1,e.keepPreviousImg=!1,e.toModify=!1,null!==o.data.updatedData.imageUrl&&(e.previousImage=o.data.updatedData.imageUrl,e.previewImageEdit=e.previousImage),e.$emit("postupdated"),t.next=24;break;case 19:t.prev=19,t.t0=t["catch"](5),console.log(t.t0.response.data),e.validEdit=!1,e.errorMessageEdit=t.t0.response.data.message;case 24:case"end":return t.stop()}}),t,null,[[5,19]])})))()},abort:function(){this.toModify=!1,this.messageEdit=this.$props.post.content,this.previewImageEdit=this.previousImage,this.selectedFileEdit=null,this.deleteImg=!1,this.keepPreviousImg=!1,this.errorMessageEdit="",this.validEdit=!0},onFileSelected:function(e){var t=this,s=e.target.files[0];if(!s)return this.deleteImg?this.previewImageEdit="":this.previewImageEdit=this.previousImage,void(this.selectedFileEdit=null);var r=["image/jpg","image/jpeg","image/png","image/webp","image/gif"],n=1048576,a=s.size>n;if(r.includes(s.type)&&!a){this.selectedFileEdit=e.target.files[0];var o=new FileReader;o.onload=function(e){t.previewImageEdit=e.target.result},o.readAsDataURL(s)}else this.validEdit=!1,this.errorMessageEdit=a?"Fichier trop volumineux : la taille ne doit pas dépasser 1 Mo":"Seules les images sont autorisées",this.$refs.imageInput.value=""},removeImage:function(){this.previewImageEdit="",this.selectedFileEdit=null,this.deleteImg=!0},resetErrorMessage:function(){this.validEdit=!0}},mounted:function(){this.$refs.mycardtext.innerHTML=Te(this.$props.post.content),this.previewImageEdit&&(this.previousImage=this.previewImageEdit)},updated:function(){console.log("PostItem mis à jour"),this.$refs.mycardtext.innerHTML=Te(this.$props.post.content)}},Ke=(0,D.Z)(Ye,[["render",Fe],["__scopeId","data-v-2345d7f4"]]),Qe=Ke,Xe={name:"FeedCompo",components:{PostItem:Qe},data:function(){return{posts:[]}},methods:{getAllPosts:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=localStorage.getItem("token"),t.prev=1,t.next=4,Ce.get("posts",{headers:{Authorization:"Bearer ".concat(s)}});case 4:r=t.sent,e.posts=r.data,console.log("posts dans Feed",e.posts),e.$store.dispatch("setPosts",r.data),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()}},beforeMount:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getAllPosts();case 1:case"end":return t.stop()}}),t)})))()}},et=(0,D.Z)(Xe,[["render",ee],["__scopeId","data-v-78648f79"]]),tt=et;var st=function(e){return(0,n.dD)("data-v-8eaaa642"),e=e(),(0,n.Cn)(),e},rt={class:"card newpost-card mt-5",id:"newpost"},nt={class:"d-flex justify-content-between align-items-center mb-4"},at={class:"me-2"},ot=["src"],it={class:"me-auto w-100"},lt=["src"],ut={key:1,class:"validFeedback"},ct={class:"d-flex justify-content-end mb-2 card-btns"},dt=st((function(){return(0,n._)("label",{for:"newPostImage",class:"form-label image-label d-flex"},[(0,n._)("i",{class:"fas fa-image image-icon"}),(0,n.Uk)("Image")],-1)})),pt=["disabled"];function mt(e,t,s,a,o,i){return(0,n.wg)(),(0,n.iD)("section",rt,[(0,n._)("form",{class:"bg-white p-3",onSubmit:t[5]||(t[5]=(0,r.iM)((function(){return i.handleSubmit&&i.handleSubmit.apply(i,arguments)}),["prevent"])),id:"myForm",enctype:"multipart/form-data"},[(0,n._)("div",nt,[(0,n._)("div",at,[(0,n._)("img",{class:"rounded-circle avatar",src:e.user.avatar,alt:"avatar"},null,8,ot)]),(0,n._)("div",it,[(0,n.wy)((0,n._)("textarea",{onClick:t[0]||(t[0]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.message=e}),type:"text",class:"form-control",id:"newPostInput",placeholder:"Quoi de neuf ?",rows:"5"},null,512),[[r.nr,o.message]])])]),o.previewImage?((0,n.wg)(),(0,n.iD)("img",{key:0,class:"image-preview mb-4",src:o.previewImage},null,8,lt)):(0,n.kq)("",!0),o.valid?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",ut,(0,re.zw)(o.errorMessage),1)),(0,n._)("div",ct,[dt,o.previewImage?((0,n.wg)(),(0,n.iD)("button",{key:1,onClick:t[4]||(t[4]=function(){return i.removeImage&&i.removeImage.apply(i,arguments)}),class:"btn btn-remove"},"Retirer image")):((0,n.wg)(),(0,n.iD)("input",{key:0,type:"file",id:"newPostImage",ref:"newPostImage",class:"form-control btn-upload",onChange:t[2]||(t[2]=function(){return i.onFileSelected&&i.onFileSelected.apply(i,arguments)}),onClick:t[3]||(t[3]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)})},null,544)),(0,n._)("button",{disabled:!o.valid,type:"submit",class:"btn btn-groupo btn-publish"},"Publier",8,pt)])],32)])}const gt={name:"NewPost",data:function(){return{message:"",selectedFile:null,previewImage:"",valid:!0,errorMessage:""}},computed:(0,S.Z)({},(0,M.Se)(["user"])),methods:{handleSubmit:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r,n;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={content:e.message},null!==e.selectedFile&&(r=new FormData,r.append("post",JSON.stringify({content:e.message})),r.append("image",e.selectedFile),s=r),n=localStorage.getItem("token"),t.prev=3,t.next=6,Ce.post("posts",s,{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 6:e.message="",e.selectedFile=null,e.previewImage="",e.valid=!0,e.errorMessage="",e.$emit("newpost"),t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](3),console.log(t.t0.response.data),e.valid=!1,e.errorMessage=t.t0.response.data.message;case 19:case"end":return t.stop()}}),t,null,[[3,14]])})))()},onFileSelected:function(e){var t=this,s=e.target.files[0];if(s){var r=["image/jpg","image/jpeg","image/png","image/webp","image/gif"],n=1048576,a=s.size>n;if(r.includes(s.type)&&!a){this.selectedFile=e.target.files[0];var o=new FileReader;o.onload=function(e){t.previewImage=e.target.result},o.readAsDataURL(s)}else this.valid=!1,this.errorMessage=a?"Fichier trop volumineux : la taille ne doit pas dépasser 1 Mo":"Seules les images sont autorisées",this.$refs.newPostImage.value=""}},removeImage:function(){this.previewImage="",this.selectedFile=null},resetErrorMessage:function(){this.valid=!0}}},ft=(0,D.Z)(gt,[["render",mt],["__scopeId","data-v-8eaaa642"]]),vt=ft,bt={name:"HomeView",components:{NewPost:vt,Feed:tt},data:function(){return{compoKey:0}},computed:(0,S.Z)({},(0,M.Se)(["user"])),mounted:function(){console.log("logged",this.$store.state.logged)},updated:function(){console.log("HomeView mis à jour !")},methods:{setReload:function(){this.compoKey+=1}}},ht=(0,D.Z)(bt,[["render",H],["__scopeId","data-v-90a29676"]]),wt=ht;var kt=function(e){return(0,n.dD)("data-v-570625b1"),e=e(),(0,n.Cn)(),e},yt={class:"container-compo mx-auto"},jt={class:"container"},_t=kt((function(){return(0,n._)("h1",{class:"mb-4"},"Inscription",-1)})),It={class:"mb-3"},xt=kt((function(){return(0,n._)("label",{for:"usernameInput",class:"form-label"},"Pseudo",-1)})),St={class:"mb-3"},Mt=kt((function(){return(0,n._)("label",{for:"emailInput",class:"form-label"},"Email",-1)})),Et={class:"mb-4"},Dt=kt((function(){return(0,n._)("label",{for:"passwordInput",class:"form-label"},"Mot de passe",-1)})),Zt={key:0,id:"errorMessageId",class:"validFeedback"},Ut=kt((function(){return(0,n._)("button",{type:"submit",class:"btn btn-primary btn-groupo"},"Créer un compte",-1)})),Ft={class:"mt-3"},Lt=(0,n.Uk)("Déjà un compte ? "),$t=(0,n.Uk)("Connexion");function zt(e,t,s,a,o,i){var l=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",yt,[(0,n._)("div",jt,[_t,(0,n._)("form",{onSubmit:t[6]||(t[6]=(0,r.iM)((function(){return i.handleSubmit&&i.handleSubmit.apply(i,arguments)}),["prevent"]))},[(0,n._)("div",It,[xt,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.username=e}),onClick:t[1]||(t[1]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),type:"text",class:"form-control",id:"usernameInput",required:""},null,512),[[r.nr,o.username]])]),(0,n._)("div",St,[Mt,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.email=e}),onClick:t[3]||(t[3]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),type:"email",class:"form-control",id:"emailInput",required:""},null,512),[[r.nr,o.email]])]),(0,n._)("div",Et,[Dt,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[4]||(t[4]=function(e){return o.password=e}),onClick:t[5]||(t[5]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),type:"password",class:"form-control",id:"passwordInput",required:""},null,512),[[r.nr,o.password]])]),o.valid?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",Zt,(0,re.zw)(o.errorMessage),1)),Ut,(0,n._)("p",Ft,[Lt,(0,n.Wm)(l,{to:"/login"},{default:(0,n.w5)((function(){return[$t]})),_:1})])],32)])])}const Pt={name:"SignUp",data:function(){return{username:"",email:"",password:"",valid:!0,errorMessage:""}},methods:{handleSubmit:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={username:e.username,email:e.email,password:e.password},t.prev=1,t.next=4,Ce.post("users/signup",s);case 4:alert("Inscription réussie. Veuillez vous connecter."),e.$router.push("/login"),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),e.valid=!1,t.t0.response.data.message.includes("The string")?e.errorMessage="Votre mot de passe doit contenir 8 caractères au minimum, contenir des lettres (au moins une majuscule et au moins une minuscule), au moins 2 chiffres ainsi qu'au moins un caractère spécial.":e.errorMessage=t.t0.response.data.message;case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},resetErrorMessage:function(){this.valid=!0}}},Ct=(0,D.Z)(Pt,[["render",zt],["__scopeId","data-v-570625b1"]]),Tt=Ct;var Ot=function(e){return(0,n.dD)("data-v-5f1a2b46"),e=e(),(0,n.Cn)(),e},At={class:"container-compo mx-auto"},qt={class:"container"},Nt=Ot((function(){return(0,n._)("h1",{class:"mb-4"},"Connexion",-1)})),Bt={class:"mb-3"},Vt=Ot((function(){return(0,n._)("label",{for:"usernameInput",class:"form-label"},"Pseudo",-1)})),Rt={class:"mb-4"},Wt=Ot((function(){return(0,n._)("label",{for:"passwordInput",class:"form-label"},"Mot de passe",-1)})),Gt={key:0,id:"errorMessageId",class:"validFeedback"},Jt=Ot((function(){return(0,n._)("button",{type:"submit",class:"btn btn-primary btn-groupo"},"Se connecter",-1)})),Ht={class:"mt-3"},Yt=(0,n.Uk)("Pas encore de compte ? "),Kt=(0,n.Uk)("Inscription");function Qt(e,t,s,a,o,i){var l=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",At,[(0,n._)("div",qt,[Nt,(0,n._)("form",{onSubmit:t[4]||(t[4]=(0,r.iM)((function(){return i.handleSubmit&&i.handleSubmit.apply(i,arguments)}),["prevent"]))},[(0,n._)("div",Bt,[Vt,(0,n.wy)((0,n._)("input",{onClick:t[0]||(t[0]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.username=e}),type:"text",class:"form-control",id:"usernameInput",required:""},null,512),[[r.nr,o.username]])]),(0,n._)("div",Rt,[Wt,(0,n.wy)((0,n._)("input",{onClick:t[2]||(t[2]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.password=e}),type:"password",class:"form-control",id:"passwordInput",required:""},null,512),[[r.nr,o.password]])]),o.valid?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",Gt,(0,re.zw)(o.errorMessage),1)),Jt,(0,n._)("p",Ht,[Yt,(0,n.Wm)(l,{to:"/signup"},{default:(0,n.w5)((function(){return[Kt]})),_:1})])],32)])])}const Xt={name:"LogIn",data:function(){return{username:"",password:"",valid:!0,errorMessage:""}},methods:{handleSubmit:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={username:e.username,password:e.password},t.prev=1,t.next=4,Ce.post("users/signin",s);case 4:r=t.sent,localStorage.setItem("token",r.data.token),localStorage.setItem("userId",r.data.userId),localStorage.setItem("user",JSON.stringify(r.data.user)),e.$store.dispatch("setUser",r.data.user),e.$store.dispatch("setLogin"),e.$router.push("/"),t.next=18;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0.response.data),e.valid=!1,e.errorMessage=t.t0.response.data.message;case 18:case"end":return t.stop()}}),t,null,[[1,13]])})))()},resetErrorMessage:function(){this.valid=!0}}},es=(0,D.Z)(Xt,[["render",Qt],["__scopeId","data-v-5f1a2b46"]]),ts=es;var ss=function(e){return(0,n.dD)("data-v-705fd5c0"),e=e(),(0,n.Cn)(),e},rs={class:"container-compo mx-auto"},ns=ss((function(){return(0,n._)("h1",{class:"mb-4"},"Profil",-1)})),as={class:"card mb-4 card-profile"},os={class:"card-body text-center"},is=["src"],ls={class:"my-3"},us={class:"text-muted mb-3"},cs={class:"mb-4 text-bio",ref:"bio"},ds={class:"d-flex justify-content-center mb-2 card-btns"},ps=(0,n.Uk)("Modifier profil"),ms=(0,n.Uk)("Modifier mot de passe");function gs(e,t,s,r,a,o){var i=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",rs,[ns,(0,n._)("div",as,[(0,n._)("div",os,[(0,n._)("img",{src:a.avatar,class:"rounded-circle img-fluid avatar",alt:"avatar"},null,8,is),(0,n._)("h3",ls,(0,re.zw)(a.username),1),(0,n._)("p",us,(0,re.zw)(a.email),1),(0,n._)("p",cs,null,512),(0,n._)("div",ds,[e.loggedIn?((0,n.wg)(),(0,n.j4)(i,{key:0,to:"/modify-profile/".concat(e.user.id),class:"btn btn-primary btn-modify"},{default:(0,n.w5)((function(){return[ps]})),_:1},8,["to"])):(0,n.kq)("",!0),e.loggedIn?((0,n.wg)(),(0,n.j4)(i,{key:1,to:"/modify-password/".concat(e.user.id),class:"btn btn-primary btn-password"},{default:(0,n.w5)((function(){return[ms]})),_:1},8,["to"])):(0,n.kq)("",!0),(0,n._)("button",{onClick:t[0]||(t[0]=function(){return o.deleteUser&&o.deleteUser.apply(o,arguments)}),class:"btn btn-groupo"},"Supprimer compte")])])])])}s(91058);const fs={name:"ViewProfile",data:function(){return{username:"",email:"",bio:"",avatar:""}},computed:(0,S.Z)((0,S.Z)({},(0,M.Se)(["user"])),(0,M.Se)(["loggedIn"])),methods:{deleteUser:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r,n;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=localStorage.getItem("token"),r=localStorage.getItem("userId"),n=confirm("Vous êtes sûr(e) de supprimer votre compte ?"),n){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,t.next=8,Ce["delete"]("users/".concat(r),{headers:{Authorization:"Bearer ".concat(s)}});case 8:localStorage.removeItem("userId"),localStorage.removeItem("token"),localStorage.removeItem("user"),e.$store.dispatch("setLogout"),alert("Compte supprimé !"),e.$router.push("/signup"),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),console.log(t.t0.response.data);case 19:case"end":return t.stop()}}),t,null,[[5,16]])})))()},getUser:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r,n,a,o;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=localStorage.getItem("token"),r=e.$store.state.user.id,n=e.$route.params.id,t.prev=3,parseInt(n)===r){t.next=8;break}return alert("Accès à cette page non autorisé"),e.$router.push("/"),t.abrupt("return");case 8:return t.next=10,Ce.get("users/".concat(n),{headers:{Authorization:"Bearer ".concat(s)}});case 10:a=t.sent,e.username=a.data.username,e.email=a.data.email,e.bio=a.data.bio,e.$refs.bio.innerHTML=null!==e.bio?Te(a.data.bio):"",e.avatar=a.data.avatar,o=Object.assign((0,S.Z)({},e.$store.state.user),{email:e.email}),e.$store.dispatch("setUser",o),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](3),console.log(t.t0.response.data);case 23:case"end":return t.stop()}}),t,null,[[3,20]])})))()}},beforeMount:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getUser();case 1:case"end":return t.stop()}}),t)})))()}},vs=(0,D.Z)(fs,[["render",gs],["__scopeId","data-v-705fd5c0"]]),bs=vs;var hs=function(e){return(0,n.dD)("data-v-f86e8868"),e=e(),(0,n.Cn)(),e},ws={class:"container-compo mx-auto"},ks={class:"container mt-2"},ys=hs((function(){return(0,n._)("h1",{class:"mb-4"},"Modification du profil",-1)})),js={class:"mb-3"},_s=hs((function(){return(0,n._)("label",{for:"usernameInput",class:"form-label"},"Pseudo",-1)})),Is={class:"mb-3"},xs=hs((function(){return(0,n._)("label",{for:"emailInput",class:"form-label"},"Email",-1)})),Ss={class:"mb-3"},Ms=hs((function(){return(0,n._)("label",{for:"bioInput",class:"form-label"},"Bio",-1)})),Es={key:0,class:"validFeedback"},Ds={class:"mb-4"},Zs=hs((function(){return(0,n._)("label",{for:"avatarInput",class:"form-label"},"Avatar",-1)})),Us={key:1,class:"validFeedback"},Fs=["disabled"];function Ls(e,t,s,a,o,i){return(0,n.wg)(),(0,n.iD)("div",ws,[(0,n._)("div",ks,[ys,(0,n._)("form",{onSubmit:t[10]||(t[10]=(0,r.iM)((function(){return i.handleSubmit&&i.handleSubmit.apply(i,arguments)}),["prevent"])),id:"myForm",enctype:"multipart/form-data",class:"mb-5"},[(0,n._)("div",js,[_s,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.username=e}),onClick:t[1]||(t[1]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),type:"text",class:"form-control",id:"usernameInput",required:""},null,512),[[r.nr,o.username]])]),(0,n._)("div",Is,[xs,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.email=e}),type:"email",class:"form-control",id:"emailInput",disabled:""},null,512),[[r.nr,o.email]])]),(0,n._)("div",Ss,[Ms,(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.bio=e}),onClick:t[4]||(t[4]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)}),type:"text",class:"form-control",id:"bioInput",rows:"5",onInput:t[5]||(t[5]=function(){return i.checkBio&&i.checkBio.apply(i,arguments)})},null,544),[[r.nr,o.bio]])]),o.isBioTooLong?((0,n.wg)(),(0,n.iD)("p",Es,"La bio ne doit pas dépasser les 255 caractères autorisés")):(0,n.kq)("",!0),(0,n._)("div",Ds,[Zs,(0,n._)("div",{class:"imagePreviewWrapper mb-3",style:(0,re.j5)({"background-image":"url(".concat(o.previewAvatar,")")})},null,4),o.isNewAvatar?((0,n.wg)(),(0,n.iD)("button",{key:1,onClick:t[8]||(t[8]=(0,r.iM)((function(){return i.removeImage&&i.removeImage.apply(i,arguments)}),["prevent"])),class:"btn btn-cancel mb-3"},"Annuler changement avatar")):((0,n.wg)(),(0,n.iD)("input",{key:0,class:"form-control",type:"file",id:"avatarInput",ref:"fileInput",onChange:t[6]||(t[6]=function(){return i.onFileSelected&&i.onFileSelected.apply(i,arguments)}),onClick:t[7]||(t[7]=function(){return i.resetErrorMessage&&i.resetErrorMessage.apply(i,arguments)})},null,544))]),o.valid?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",Us,(0,re.zw)(o.errorMessage),1)),(0,n._)("button",{onClick:t[9]||(t[9]=(0,r.iM)((function(){return i.abort&&i.abort.apply(i,arguments)}),["prevent"])),class:"btn btn-light btn-space btn-abort"},"Retour"),(0,n._)("button",{disabled:!o.valid,type:"submit",class:"btn btn-space btn-groupo"},"Sauvegarder",8,Fs)],32)])])}const $s={name:"ModifyProfile",data:function(){return{username:this.$store.state.user.username,email:this.$store.state.user.email,bio:this.$store.state.user.bio,userId:this.$store.state.user.id,selectedFile:null,valid:!0,errorMessage:"",previewAvatar:this.$store.state.user.avatar,previousAvatar:this.$store.state.user.avatar,isBioTooLong:!1,isNewAvatar:!1}},computed:(0,S.Z)({},(0,M.Se)(["user"])),methods:{handleSubmit:function(){var e=this;return(0,se.Z)((0,te.Z)().mark((function t(){var s,r,n,a,o,i,l,u;return(0,te.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={username:e.username,bio:e.bio},r=s,null!==e.selectedFile&&(n=new FormData,n.append("user",JSON.stringify(s)),n.append("avatar",e.selectedFile),r=n),a=localStorage.getItem("token"),o=localStorage.getItem("userId"),t.prev=5,t.next=8,Ce.put("users/".concat(o),r,{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});case 8:i=t.sent,l=i.data.updatedData,u=Object.assign((0,S.Z)({},e.$store.state.user),(0,S.Z)({},l)),localStorage.setItem("user",JSON.stringify(u)),e.$store.dispatch("setUser",u),alert("Les modifications ont bien été enregistrées !"),e.$router.go(-1),t.next=22;break;case 17:t.prev=17,t.t0=t["catch"](5),console.log(t.t0.response.data),e.valid=!1,e.errorMessage=t.t0.response.data.message;case 22:case"end":return t.stop()}}),t,null,[[5,17]])})))()},onFileSelected:function(e){var t=this,s=e.target.files[0];if(!s)return this.previewAvatar=this.previousAvatar,void(this.selectedFile=null);var r=["image/jpg","image/jpeg","image/png","image/webp","image/gif"],n=1048576,a=s.size>n;if(r.includes(s.type)&&!a){this.selectedFile=e.target.files[0],this.isNewAvatar=!0;var o=new FileReader;o.onload=function(e){t.previewAvatar=e.target.result},o.readAsDataURL(s)}else this.valid=!1,this.errorMessage=a?"Fichier trop volumineux : la taille ne doit pas dépasser 1 Mo":"Seules les images sont autorisées",this.$refs.fileInput.value=""},abort:function(){this.$router.go(-1)},resetErrorMessage:function(){this.valid=!0},checkBio:function(){var e=document.getElementById("bioInput").value.length;e>255?(this.isBioTooLong=!0,this.valid=!1):this.isBioTooLong=!1},removeImage:function(){this.previewAvatar=this.previousAvatar,this.selectedFile=null,this.isNewAvatar=!1}}},zs=(0,D.Z)($s,[["render",Ls],["__scopeId","data-v-f86e8868"]]),Ps=zs;var Cs=[{path:"/",name:"home",component:wt},{path:"/signup",name:"signup",component:Tt},{path:"/login",name:"login",component:ts},{path:"/view-profile/:id",name:"view-profile",component:bs},{path:"/modify-profile/:id",name:"modify-profile",component:Ps}],Ts=(0,z.p7)({history:(0,z.PO)("/"),routes:Cs});const Os=Ts;s(3843),s(83710);var As=s(61598);const qs=(0,M.MT)({state:{user:null,logged:!1,posts:[]},getters:{user:function(e){return e.user},loggedIn:function(e){return e.logged}},mutations:{SET_USER:function(e,t){e.user=t},SET_LOGIN:function(e){e.logged=!0},SET_LOGOUT:function(e){e.logged=!1,e.user=null,e.posts=[]},SET_POSTS:function(e,t){e.posts=t}},actions:{setUser:function(e,t){e.commit("SET_USER",t)},setLogin:function(e){var t=e.commit;t("SET_LOGIN")},setLogout:function(e){var t=e.commit;t("SET_LOGOUT")},setPosts:function(e,t){e.commit("SET_POSTS",t)},checkToken:function(e){var t=e.commit;if(localStorage.getItem("token")){var s=localStorage.getItem("token"),r=(0,As.Z)(s);console.log("*** Heures restantes avant expiration Token ***",Math.round((1e3*r.exp-Date.now())/1e3/3600*100)/100),Date.now()>=1e3*r.exp?(console.log("token expiré"),alert("Session expirée - Veuillez vous reconnecter"),localStorage.clear(),t("SET_LOGOUT")):(t("SET_LOGIN"),t("SET_USER",JSON.parse(localStorage.getItem("user"))))}else console.log("pas de token"),t("SET_LOGOUT")}},modules:{}});(0,r.ri)($).use(qs).use(Os).mount("#app")}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.m=e,(()=>{var e=[];s.O=(t,r,n,a)=>{if(!r){var o=1/0;for(c=0;c<e.length;c++){for(var[r,n,a]=e[c],i=!0,l=0;l<r.length;l++)(!1&a||o>=a)&&Object.keys(s.O).every((e=>s.O[e](r[l])))?r.splice(l--,1):(i=!1,a<o&&(o=a));if(i){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,n,a]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{s.p="/"})(),(()=>{var e={143:0};s.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[o,i,l]=r,u=0;if(o.some((t=>0!==e[t]))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var c=l(s)}for(t&&t(r);u<o.length;u++)a=o[u],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(c)},r=self["webpackChunkgroupo"]=self["webpackChunkgroupo"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=s.O(void 0,[998],(()=>s(95153)));r=s.O(r)})();
//# sourceMappingURL=app.037ab0ae.js.map